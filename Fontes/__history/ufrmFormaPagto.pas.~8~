unit ufrmFormaPagto;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseGrade, Data.DB,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, System.Actions, Vcl.ActnList,
  System.ImageList, Vcl.ImgList, Vcl.Menus, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, Vcl.ComCtrls, Vcl.ToolWin, Vcl.Grids, Vcl.DBGrids,
  Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls, Vcl.DBCtrls;

type
  TfrmFormaPagto = class(TfrmBaseGrade)
    qryID: TIntegerField;
    qryDESCRICAO: TStringField;
    qryINTERVALO: TSmallintField;
    qryQTDE_PARCELAS: TSmallintField;
    qryPRIM_VENC: TSmallintField;
    qryATIVO: TStringField;
    procedure FormCreate(Sender: TObject);
    procedure actIncluirExecute(Sender: TObject);
    procedure actAlterarExecute(Sender: TObject);
    procedure actExcluirExecute(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

  procedure executa;

implementation

uses udmConn;


procedure executa;
var
  loForm : TfrmFormaPagto;
begin
  try
    loForm := TfrmFormaPagto.Create(Application);
    loForm.ShowModal;
  finally
    FreeAndNil(loForm);
  end;
end;

{$R *.dfm}

procedure TfrmFormaPagto.actAlterarExecute(Sender: TObject);
begin
  inherited;
  if not qry.IsEmpty then qry.Edit;
end;

procedure TfrmFormaPagto.actExcluirExecute(Sender: TObject);
begin
  inherited;
  if not qry.IsEmpty then
    if Application.MessageBox('Confirma a exclusão','Atenção',MB_OKCANCEL) = mrOk then
    begin
      qry.Edit;
      qry.FieldByName('ATIVO').AsString := 'N';
      qry.Post;
    end;

end;

procedure TfrmFormaPagto.actIncluirExecute(Sender: TObject);
begin
  inherited;
  qry.Insert;
  qry.FieldByName('ATIVO').AsString := 'S';
end;

procedure TfrmFormaPagto.FormCreate(Sender: TObject);
begin
  inherited;
  qry.Open('select * from FORMAS_PAGTO');
  sSql := qry.SQL.Text;
end;

end.
