unit ufrmPessoas;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseGrade, Data.DB,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, System.Actions, Vcl.ActnList,
  System.ImageList, Vcl.ImgList, Vcl.Menus, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, Vcl.ComCtrls, Vcl.ToolWin, Vcl.Grids, Vcl.DBGrids,
  Vcl.StdCtrls, Vcl.ExtCtrls, Vcl.Buttons, Vcl.DBCtrls;

type
  TfrmPessoas = class(TfrmBaseGrade)
    qryID: TIntegerField;
    qryNOME: TStringField;
    qryCPF_CNPJ: TStringField;
    qryTELEFONE: TStringField;
    qryCELULAR: TStringField;
    qryATIVO: TStringField;

    procedure actIncluirExecute(Sender: TObject);
    procedure actAlterarExecute(Sender: TObject);
    procedure actExcluirExecute(Sender: TObject);

    procedure FormCreate(Sender: TObject);

  private
    procedure ASql();


  public
  end;

  //procedure executa();
  var
    frmPessoas : TfrmPessoas;

implementation

{$R *.dfm}

uses uBiblioteca, ufrmPessoasE, udmConn;
(*
procedure executa();
var
  loForm: TfrmPessoas;
begin
  try
    loForm := TfrmPessoas.Create(Application);
    loForm.ShowModal;
  finally
    freeandnil(loForm);
  end;
end;
*)


procedure TfrmPessoas.actAlterarExecute(Sender: TObject);
var
 id : integer;
begin
  inherited;
  id := qry.fieldbyname('ID').AsInteger;
  ufrmPessoasE.Alterar( id );
  uBiblioteca.AtualizaQuery(qry);

  qry.Locate('ID', id, []);

end;

procedure TfrmPessoas.actExcluirExecute(Sender: TObject);
begin
  inherited;
  if not qry.IsEmpty then
  begin
    ufrmPessoasE.Excluir(qry.fieldbyname('ID').AsInteger);
    uBiblioteca.AtualizaQuery(qry);
  end;

end;

procedure TfrmPessoas.actIncluirExecute(Sender: TObject);
begin
  inherited;
  ufrmPessoasE.Incluir;
  uBiblioteca.AtualizaQuery(qry);

end;

procedure TfrmPessoas.ASql;
begin
  qry.Open('select * from ' + Self.Tabela + ' where ID = -1');
end;

procedure TfrmPessoas.FormCreate(Sender: TObject);
begin
  // property tabela no form BaseGrade
  self.Tabela := 'PESSOAS';
  ASql();

  inherited;

end;


end.
