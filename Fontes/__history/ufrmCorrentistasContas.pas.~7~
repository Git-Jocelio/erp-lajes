unit ufrmCorrentistasContas;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseEdicao, FireDAC.Stan.Intf,
  FireDAC.Stan.Option, FireDAC.Stan.Param, FireDAC.Stan.Error, FireDAC.DatS,
  FireDAC.Phys.Intf, FireDAC.DApt.Intf, FireDAC.Stan.Async, FireDAC.DApt,
  Data.DB, FireDAC.Comp.DataSet, FireDAC.Comp.Client, Vcl.StdCtrls, Vcl.Buttons,
  Vcl.ExtCtrls, Vcl.DBCtrls, Vcl.Mask, uTipos, unit_funcoes, udmConn;

type
  TfrmCorrentistasContas = class(TfrmBaseEdicao)
    Label1: TLabel;
    cbx_bancos: TDBLookupComboBox;
    Label2: TLabel;
    edt_agencia: TEdit;
    Label3: TLabel;
    edt_nr_conta: TEdit;
    btn_novo_banco: TBitBtn;
    edt_cod_banco: TDBEdit;
    procedure FormShow(Sender: TObject);
    procedure btnOkClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    Fp_confirmado: boolean;
    Fp_operacao: uTipos.TOperacao;
    Fp_agencia: string;
    Fp_banco: string;
    Fp_nrconta: string;
    procedure prc_componentes;
    procedure prc_inicializar;
    function fnc_validar: boolean;
    procedure prc_salvar;
    { Private declarations }
  public
    { Public declarations }
    property p_operacao :uTipos.TOperacao read Fp_operacao write Fp_operacao;
    property p_confirmado :boolean read Fp_confirmado write Fp_confirmado;

    // dados da conta bancaria do cliente
    property p_banco :string read Fp_banco write Fp_banco;
    property p_agencia :string read Fp_agencia write Fp_agencia;
    property p_nrconta :string read Fp_nrconta write Fp_nrconta;

  end;

var
  frmCorrentistasContas: TfrmCorrentistasContas;

implementation

{$R *.dfm}

procedure TfrmCorrentistasContas.prc_salvar;
begin
  if not fnc_validar then exit;

  {carregar as propriedades}
  p_banco   := edt_cod_banco.Text;
  p_agencia := edt_agencia.Text;
  p_nrconta := edt_nr_conta.Text;

  {confirmado}
  p_confirmado := true;
  close;
end;

procedure TfrmCorrentistasContas.btnOkClick(Sender: TObject);
begin
  prc_salvar
end;

function TfrmCorrentistasContas.fnc_validar: boolean;
begin
  result := false;

  if cbx_bancos.Text = ''  then
  begin
    unit_funcoes.criarMensagem('ERRO','INFORME UM BANCO..');
    cbx_bancos.SetFocus;
    exit;
  end;

  if edt_agencia.Text = ''  then
  begin
    unit_funcoes.criarMensagem('ERRO','INFORME O NÚMERO DA AGÊNCIA BANCARIA.');
    edt_agencia.SetFocus;
    exit;
  end;

  if edt_nr_conta.Text = ''  then
  begin
    unit_funcoes.criarMensagem('ERRO','INFORME O NÚMERO DA CONTA BANCARIA.');
    edt_nr_conta.SetFocus;
    exit;
  end;


  result := true;
end;



procedure TfrmCorrentistasContas.FormCreate(Sender: TObject);
begin
  inherited;
  titulo := 'CADASTRO DE CONTA BANCÁRIA DO CLIENTE';

end;

procedure TfrmCorrentistasContas.FormShow(Sender: TObject);
begin
  prc_componentes;
  prc_inicializar;
end;

procedure TfrmCorrentistasContas.prc_componentes;
begin
  lbl_sub_titulo.Caption := 'Preencha os dados da conta bancária do cliente.';
  qry.Open;
end;

procedure TfrmCorrentistasContas.prc_inicializar;
begin
  pnTitulo.Caption := 'CONTA BANCARIA DE CLIENTES';

  case p_operacao of
  uTipos.opIncluir: begin

                       lbl_sub_titulo.Caption    := 'INCLUSÃO';
                       btnOk.Caption             := 'Incluir';

                     end;
  uTipos.opAlterar: begin

                      lbl_sub_titulo.Caption    := 'ALTERAÇÃO';
                      btnOk.Caption             := 'Alterar';
                      btnOk.SetFocus;

                    end;
  uTipos.opExcluir: begin

                      lbl_sub_titulo.Caption := 'EXCLUIR';
                      pnDados.Enabled        := false;
                      btnOk.Caption          := 'Excluir';
                      btnFechar.SetFocus;

                    end;
  else
    begin
      pnDados.Enabled   := false;
      if btnFechar.CanFocus then btnFechar.SetFocus;
    end;
  end;

end;


end.
