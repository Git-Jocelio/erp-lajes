unit ufrmProdutosVigas_Pesquisa;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseGrade, Data.DB,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, System.Actions, Vcl.ActnList,
  System.ImageList, Vcl.ImgList, Vcl.Menus, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, Vcl.ComCtrls, Vcl.ToolWin, Vcl.Grids, Vcl.DBGrids,
  Vcl.StdCtrls, Vcl.Buttons;

type
  TfrmProdutosVigas_Pesquisa = class(TfrmBaseGrade)
    qryID: TIntegerField;
    qryNOME_FANTASIA: TStringField;
    qryUNIDADE: TStringField;
    qryPRECO_CUSTO: TCurrencyField;
    qryPRECO_VENDEDOR: TCurrencyField;
    qryPRECO_VENDA: TCurrencyField;
    procedure FormCreate(Sender: TObject);
    procedure FormShow(Sender: TObject);
  private
    procedure aSql;
  public
    { Public declarations }
  end;


procedure executa;


implementation

{$R *.dfm}


procedure executa;
var
  loForm : TfrmProdutosVigas_Pesquisa;
begin
  loForm := TfrmProdutosVigas_Pesquisa.Create(application);
  try
    loForm.ShowModal;

  finally
    freeandnil(loForm)
  end;

end;



{ TfrmProdutosVigas_Pesquisa }

procedure TfrmProdutosVigas_Pesquisa.aSql;
begin
  qry.Close;
  qry.SQL.Clear;
  qry.SQL.Text :=
              'select                    ' +
              ' P.ID,                    ' +
              ' P.NOME_FANTASIA,         ' +
              ' P.UNIDADE,               ' +
              ' P.PRECO_CUSTO,           ' +
              ' P.PRECO_VENDEDOR,        ' +
              ' P.PRECO_VENDA            ' +
              'from                      ' +
              ' PRODUTOS P,              ' +
              ' PRODUTOS_VIGAS V         ' +
              'where                     ' +
              ' P.ID = V.PRODUTO_ID and  ' +
              ' V.TRELICA_ALTURA =:ALTURA';
end;

procedure TfrmProdutosVigas_Pesquisa.FormCreate(Sender: TObject);
begin
  inherited;
  aSql;
end;

procedure TfrmProdutosVigas_Pesquisa.FormShow(Sender: TObject);
begin
  inherited;
  qry.Close;
  qry.ParamByName('ALTURA').AsInteger := 120;
  qry.Open();
end;

end.
