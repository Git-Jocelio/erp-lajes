unit ufrmProdutosVigas_Pesquisa;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseGrade, Data.DB,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, System.Actions, Vcl.ActnList,
  System.ImageList, Vcl.ImgList, Vcl.Menus, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, Vcl.ComCtrls, Vcl.ToolWin, Vcl.Grids, Vcl.DBGrids,
  Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls, Vcl.DBCtrls;

type
  TfrmProdutosVigas_Pesquisa = class(TfrmBaseGrade)
    qryID: TIntegerField;
    qryNOME_FANTASIA: TStringField;
    qryUNIDADE: TStringField;
    qryPRECO_CUSTO: TCurrencyField;
    qryPRECO_VENDEDOR: TCurrencyField;
    qryPRECO_VENDA: TCurrencyField;
    RadioGroup1: TRadioGroup;
    procedure FormCreate(Sender: TObject);
    procedure actLocalizarExecute(Sender: TObject);
  private
    procedure aSql;
  public
    { Public declarations }
  end;


procedure executa;


implementation

{$R *.dfm}


procedure executa;
var
  loForm : TfrmProdutosVigas_Pesquisa;
begin
  loForm := TfrmProdutosVigas_Pesquisa.Create(application);
  try
    loForm.ShowModal;

  finally
    freeandnil(loForm)
  end;

end;



{ TfrmProdutosVigas_Pesquisa }

procedure TfrmProdutosVigas_Pesquisa.actLocalizarExecute(Sender: TObject);
begin
  inherited;
var
  loAltura: integer;
begin
  inherited;
  if rgAltura.ItemIndex = 0 then loAltura := 80;
  if rgAltura.ItemIndex = 1 then loAltura := 120;
  if rgAltura.ItemIndex = 2 then loAltura := 160;
  if rgAltura.ItemIndex = 3 then loAltura := 200;
  if rgAltura.ItemIndex = 4 then loAltura := 250;
  if rgAltura.ItemIndex = 5 then loAltura := 300;


  qry.Close;
  qry.ParamByName('ALTURA').AsInteger := loAltura;
  qry.Open();

end;

end;

procedure TfrmProdutosVigas_Pesquisa.aSql;
begin
  qry.Close;
  qry.SQL.Clear;
  qry.SQL.Text :=
              'select                    ' +
              ' P.ID,                    ' +
              ' P.NOME_FANTASIA,         ' +
              ' P.UNIDADE,               ' +
              ' P.PRECO_CUSTO,           ' +
              ' P.PRECO_VENDEDOR,        ' +
              ' P.PRECO_VENDA            ' +
              'from                      ' +
              ' PRODUTOS P,              ' +
              ' PRODUTOS_VIGAS V         ' +
              'where                     ' +
              ' P.ID = V.PRODUTO_ID and  ' +
              ' V.TRELICA_ALTURA =:ALTURA';
end;

procedure TfrmProdutosVigas_Pesquisa.FormCreate(Sender: TObject);
begin
  inherited;
  aSql;
end;

end.
