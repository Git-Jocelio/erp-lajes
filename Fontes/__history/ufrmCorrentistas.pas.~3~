unit ufrmCorrentistas;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, ufrmBaseGrade, Data.DB,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, System.Actions, Vcl.ActnList,
  System.ImageList, Vcl.ImgList, FireDAC.Comp.DataSet, FireDAC.Comp.Client,
  Vcl.Buttons, Vcl.Grids, Vcl.DBGrids, Vcl.ExtCtrls, Vcl.ComCtrls, Vcl.ToolWin,
  Vcl.StdCtrls, udmconn, ufrmCorrentistasE, uTipos, uBiblioteca;

type
  TfrmCorrentistas = class(TfrmBaseGrade)
    qryCPF_CNPJ: TStringField;
    qryNOME: TStringField;
    qryDATA_CAD: TDateField;
    procedure FormCreate(Sender: TObject);
    procedure actIncluirExecute(Sender: TObject);
  private
    procedure prc_sql;
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmCorrentistas: TfrmCorrentistas;

implementation

{$R *.dfm}

procedure TfrmCorrentistas.actIncluirExecute(Sender: TObject);
begin
  try
    if frmCorrentistasE = nil then
      frmCorrentistasE := TfrmCorrentistasE.Create(application);

    frmCorrentistasE.Operacao := utipos.OpIncluir;
    frmCorrentistasE.ShowModal;

  finally
    ubiblioteca.AtualizaQuery(qry);
    FreeAndNil(frmCorrentistasE)
  end;
end;

procedure TfrmCorrentistas.FormCreate(Sender: TObject);
begin

  Tabela := 'CORRENTISTAS';
  prc_sql;
end;

procedure TfrmCorrentistas.prc_sql;
begin
  sSql :=
          'select              ' +
          '  p.cpf_cnpj,       ' +
          '  p.nome,           ' +
          '  p.data_cad        ' +
          'from                ' +
          '  pessoas p,        ' +
          '  correntistas c    ' +
          'where               ' +
          '  p.id = c.pessoa_id';

  qry.sql.Clear;
  qry.sql.Add(sSql);
  QRY.Open;

end;


end.
